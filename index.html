<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Professional Resume Builder</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            padding: 20px;
            max-width: 1400px;
            margin: 0 auto;
        }

        .editor-panel {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
            height: fit-content;
            max-height: 90vh;
            overflow-y: auto;
        }

        .preview-panel {
            background: white;
            border-radius: 15px;
            padding: 0;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
            position: sticky;
            top: 20px;
            height: fit-content;
            max-height: 90vh;
            overflow-y: auto;
        }

        h1 {
            color: #2c3e50;
            margin-bottom: 30px;
            text-align: center;
            font-size: 2.5rem;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .section {
            margin-bottom: 30px;
            padding: 20px;
            border: 2px solid #f1f3f4;
            border-radius: 10px;
            transition: all 0.3s ease;
        }

        .section:hover {
            border-color: #667eea;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.1);
        }

        .section h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.3rem;
            border-bottom: 2px solid #667eea;
            padding-bottom: 5px;
        }

        input, textarea, select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e1e8ed;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.3s ease;
            margin-bottom: 15px;
        }

        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        textarea {
            min-height: 100px;
            resize: vertical;
        }

        .file-input-wrapper {
            position: relative;
            display: inline-block;
            width: 100%;
            margin-bottom: 15px;
        }

        .file-input {
            position: absolute;
            left: -9999px;
        }

        .file-input-label {
            display: block;
            padding: 12px;
            background: #f8f9fa;
            border: 2px dashed #667eea;
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .file-input-label:hover {
            background: #667eea;
            color: white;
        }

        .profile-pic-preview {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid #667eea;
            margin: 10px auto;
            display: block;
        }

        .btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s ease;
            margin: 5px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #28a745, #20c997);
        }

        .btn-danger {
            background: linear-gradient(135deg, #dc3545, #e83e8c);
        }

        .dynamic-section {
            margin-bottom: 15px;
            padding: 15px;
            border: 1px solid #e1e8ed;
            border-radius: 8px;
            background: #f8f9fa;
        }

        .social-links {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 10px;
            align-items: center;
        }

        .download-actions {
            text-align: center;
            margin: 20px 0;
        }

        /* Resume Preview Styles */
        .resume-preview {
            padding: 40px;
            background: white;
            color: #333;
            line-height: 1.6;
            font-size: 14px;
        }

        .resume-header {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 3px solid #667eea;
            padding-bottom: 20px;
        }

        .resume-header h1 {
            font-size: 2.5rem;
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .contact-info {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 15px;
        }

        .profile-picture {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            object-fit: cover;
            border: 4px solid #667eea;
            margin: 0 auto 20px;
        }

        .resume-section {
            margin-bottom: 25px;
        }

        .resume-section h2 {
            color: #2c3e50;
            font-size: 1.4rem;
            margin-bottom: 15px;
            border-bottom: 2px solid #667eea;
            padding-bottom: 5px;
        }

        .experience-item, .education-item, .certification-item {
            margin-bottom: 15px;
            padding-left: 15px;
            border-left: 3px solid #667eea;
        }

        .experience-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 5px;
        }

        .job-title {
            font-weight: bold;
            color: #2c3e50;
        }

        .company {
            font-style: italic;
            color: #555;
        }

        .date-range {
            color: #667eea;
            font-weight: 500;
        }

        .skills-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
        }

        .skill-item {
            background: #f8f9fa;
            padding: 8px 12px;
            border-radius: 20px;
            text-align: center;
            border: 1px solid #e1e8ed;
        }

        .languages-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
        }

        .language-item {
            display: flex;
            justify-content: space-between;
            padding: 5px 0;
            border-bottom: 1px solid #e1e8ed;
        }

        .reference-item {
            margin-bottom: 15px;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 8px;
        }

        @media (max-width: 768px) {
            .container {
                grid-template-columns: 1fr;
            }
            
            .contact-info {
                flex-direction: column;
                gap: 10px;
            }

            .experience-header {
                flex-direction: column;
                align-items: flex-start;
            }
        }

        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Editor Panel -->
        <div class="editor-panel">
            <h1>Resume Builder</h1>
            
            <!-- Personal Information Section -->
            <div class="section fade-in">
                <h3>Personal Information</h3>
                <input type="text" id="fullName" placeholder="Full Name" oninput="updateResume()">
                <input type="text" id="phone" placeholder="Phone Number" oninput="updateResume()">
                <input type="email" id="email" placeholder="Email Address" oninput="updateResume()">
                <input type="text" id="address" placeholder="Address" oninput="updateResume()">
                
                <div class="file-input-wrapper">
                    <input type="file" id="profilePic" class="file-input" accept="image/*" onchange="handleProfilePic(this)">
                    <label for="profilePic" class="file-input-label">
                        üì∑ Upload Profile Picture
                    </label>
                </div>
                <img id="profilePreview" class="profile-pic-preview" style="display: none;">
            </div>

            <!-- Social Media Links -->
            <div class="section fade-in">
                <h3>Social Media Links</h3>
                <div id="socialLinks">
                    <div class="social-links">
                        <select>
                            <option value="linkedin">LinkedIn</option>
                            <option value="github">GitHub</option>
                            <option value="twitter">Twitter</option>
                            <option value="website">Website</option>
                        </select>
                        <input type="url" placeholder="Profile URL" oninput="updateResume()">
                    </div>
                </div>
                <button class="btn btn-secondary" onclick="addSocialLink()">+ Add Social Link</button>
            </div>

            <!-- Professional Summary -->
            <div class="section fade-in">
                <h3>Professional Summary</h3>
                <textarea id="summary" placeholder="Write a brief professional summary..." oninput="updateResume()"></textarea>
            </div>

            <!-- Skills -->
            <div class="section fade-in">
                <h3>Skills</h3>
                <div id="skillsList">
                    <input type="text" placeholder="Skill" oninput="updateResume()">
                </div>
                <button class="btn btn-secondary" onclick="addSkill()">+ Add Skill</button>
            </div>

            <!-- Experience -->
            <div class="section fade-in">
                <h3>Work Experience</h3>
                <div id="experienceList">
                    <div class="dynamic-section">
                        <input type="text" placeholder="Job Title" oninput="updateResume()">
                        <input type="text" placeholder="Company/Organization" oninput="updateResume()">
                        <input type="date" placeholder="Start Date" oninput="updateResume()">
                        <input type="date" placeholder="End Date" oninput="updateResume()">
                        <textarea placeholder="Job Description..." oninput="updateResume()"></textarea>
                        <button class="btn btn-danger" onclick="removeExperience(this)">Remove</button>
                    </div>
                </div>
                <button class="btn btn-secondary" onclick="addExperience()">+ Add Experience</button>
            </div>

            <!-- Education -->
            <div class="section fade-in">
                <h3>Education</h3>
                <div id="educationList">
                    <div class="dynamic-section">
                        <input type="text" placeholder="Degree/Qualification" oninput="updateResume()">
                        <input type="text" placeholder="Institution" oninput="updateResume()">
                        <input type="text" placeholder="Year Graduated" oninput="updateResume()">
                        <input type="text" placeholder="Grade/GPA (Optional)" oninput="updateResume()">
                        <button class="btn btn-danger" onclick="removeEducation(this)">Remove</button>
                    </div>
                </div>
                <button class="btn btn-secondary" onclick="addEducation()">+ Add Education</button>
            </div>

            <!-- Certifications -->
            <div class="section fade-in">
                <h3>Certifications</h3>
                <div id="certificationsList">
                    <div class="dynamic-section">
                        <input type="text" placeholder="Certification Name" oninput="updateResume()">
                        <input type="text" placeholder="Issuing Organization" oninput="updateResume()">
                        <input type="text" placeholder="Year Obtained" oninput="updateResume()">
                        <button class="btn btn-danger" onclick="removeCertification(this)">Remove</button>
                    </div>
                </div>
                <button class="btn btn-secondary" onclick="addCertification()">+ Add Certification</button>
            </div>

            <!-- Languages -->
            <div class="section fade-in">
                <h3>Languages</h3>
                <div id="languagesList">
                    <div class="dynamic-section">
                        <input type="text" placeholder="Language" oninput="updateResume()">
                        <select oninput="updateResume()">
                            <option value="Beginner">Beginner</option>
                            <option value="Intermediate">Intermediate</option>
                            <option value="Advanced">Advanced</option>
                            <option value="Fluent">Fluent</option>
                            <option value="Native">Native</option>
                        </select>
                        <button class="btn btn-danger" onclick="removeLanguage(this)">Remove</button>
                    </div>
                </div>
                <button class="btn btn-secondary" onclick="addLanguage()">+ Add Language</button>
            </div>

            <!-- References -->
            <div class="section fade-in">
                <h3>References</h3>
                <div id="referencesList">
                    <div class="dynamic-section">
                        <input type="text" placeholder="Reference Name" oninput="updateResume()">
                        <input type="text" placeholder="Job Title" oninput="updateResume()">
                        <input type="text" placeholder="Company" oninput="updateResume()">
                        <input type="text" placeholder="Phone Number" oninput="updateResume()">
                        <input type="email" placeholder="Email" oninput="updateResume()">
                        <button class="btn btn-danger" onclick="removeReference(this)">Remove</button>
                    </div>
                </div>
                <button class="btn btn-secondary" onclick="addReference()">+ Add Reference</button>
            </div>

            <!-- Download Settings -->
            <div class="section fade-in">
                <h3>Download Settings</h3>
                <label for="pageSize">Page Size:</label>
                <select id="pageSize">
                    <option value="a4" selected>A4 (210 √ó 297 mm)</option>
                    <option value="letter">Letter (8.5 √ó 11 in)</option>
                    <option value="legal">Legal (8.5 √ó 14 in)</option>
                    <option value="a3">A3 (297 √ó 420 mm)</option>
                    <option value="a5">A5 (148 √ó 210 mm)</option>
                    <option value="tabloid">Tabloid (11 √ó 17 in)</option>
                </select>
                
                <label for="pageOrientation">Orientation:</label>
                <select id="pageOrientation">
                    <option value="portrait" selected>Portrait</option>
                    <option value="landscape">Landscape</option>
                </select>
                
                <label for="pageMargin">Margin (inches):</label>
                <select id="pageMargin">
                    <option value="0.25">0.25 inch</option>
                    <option value="0.5" selected>0.5 inch</option>
                    <option value="0.75">0.75 inch</option>
                    <option value="1">1 inch</option>
                    <option value="1.5">1.5 inch</option>
                </select>

                <div style="margin-top: 15px;">
                    <label>
                        <input type="checkbox" id="showPageInfo" checked style="width: auto; margin-right: 10px;">
                        Show page size info in preview
                    </label>
                </div>
            </div>

            <div class="download-actions">
                <button class="btn" onclick="downloadPDF()">üìÑ Download PDF</button>
                <button class="btn" onclick="printResume()">üñ®Ô∏è Print Resume</button>
                <div id="pageInfo" style="margin-top: 10px; font-size: 12px; color: #666;">
                    Current: A4 Portrait (210 √ó 297 mm) with 0.5" margins
                </div>
            </div>
        </div>

        <!-- Preview Panel -->
        <div class="preview-panel">
            <div id="resumePreview" class="resume-preview">
                <!-- Resume content will be generated here -->
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script>
        let profilePicData = '';

        function handleProfilePic(input) {
            const file = input.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    profilePicData = e.target.result;
                    document.getElementById('profilePreview').src = profilePicData;
                    document.getElementById('profilePreview').style.display = 'block';
                    updateResume();
                };
                reader.readAsDataURL(file);
            }
        }

        function addSocialLink() {
            const container = document.getElementById('socialLinks');
            const div = document.createElement('div');
            div.className = 'social-links';
            div.innerHTML = `
                <select oninput="updateResume()">
                    <option value="linkedin">LinkedIn</option>
                    <option value="github">GitHub</option>
                    <option value="twitter">Twitter</option>
                    <option value="website">Website</option>
                </select>
                <input type="url" placeholder="Profile URL" oninput="updateResume()">
                <button class="btn btn-danger" onclick="removeSocialLink(this)">Remove</button>
            `;
            container.appendChild(div);
        }

        function removeSocialLink(btn) {
            btn.parentElement.remove();
            updateResume();
        }

        function addSkill() {
            const container = document.getElementById('skillsList');
            const input = document.createElement('input');
            input.type = 'text';
            input.placeholder = 'Skill';
            input.oninput = updateResume;
            container.appendChild(input);
        }

        function addExperience() {
            const container = document.getElementById('experienceList');
            const div = document.createElement('div');
            div.className = 'dynamic-section';
            div.innerHTML = `
                <input type="text" placeholder="Job Title" oninput="updateResume()">
                <input type="text" placeholder="Company/Organization" oninput="updateResume()">
                <input type="date" placeholder="Start Date" oninput="updateResume()">
                <input type="date" placeholder="End Date" oninput="updateResume()">
                <textarea placeholder="Job Description..." oninput="updateResume()"></textarea>
                <button class="btn btn-danger" onclick="removeExperience(this)">Remove</button>
            `;
            container.appendChild(div);
        }

        function removeExperience(btn) {
            btn.parentElement.remove();
            updateResume();
        }

        function addEducation() {
            const container = document.getElementById('educationList');
            const div = document.createElement('div');
            div.className = 'dynamic-section';
            div.innerHTML = `
                <input type="text" placeholder="Degree/Qualification" oninput="updateResume()">
                <input type="text" placeholder="Institution" oninput="updateResume()">
                <input type="text" placeholder="Year Graduated" oninput="updateResume()">
                <input type="text" placeholder="Grade/GPA (Optional)" oninput="updateResume()">
                <button class="btn btn-danger" onclick="removeEducation(this)">Remove</button>
            `;
            container.appendChild(div);
        }

        function removeEducation(btn) {
            btn.parentElement.remove();
            updateResume();
        }

        function addCertification() {
            const container = document.getElementById('certificationsList');
            const div = document.createElement('div');
            div.className = 'dynamic-section';
            div.innerHTML = `
                <input type="text" placeholder="Certification Name" oninput="updateResume()">
                <input type="text" placeholder="Issuing Organization" oninput="updateResume()">
                <input type="text" placeholder="Year Obtained" oninput="updateResume()">
                <button class="btn btn-danger" onclick="removeCertification(this)">Remove</button>
            `;
            container.appendChild(div);
        }

        function removeCertification(btn) {
            btn.parentElement.remove();
            updateResume();
        }

        function addLanguage() {
            const container = document.getElementById('languagesList');
            const div = document.createElement('div');
            div.className = 'dynamic-section';
            div.innerHTML = `
                <input type="text" placeholder="Language" oninput="updateResume()">
                <select oninput="updateResume()">
                    <option value="Beginner">Beginner</option>
                    <option value="Intermediate">Intermediate</option>
                    <option value="Advanced">Advanced</option>
                    <option value="Fluent">Fluent</option>
                    <option value="Native">Native</option>
                </select>
                <button class="btn btn-danger" onclick="removeLanguage(this)">Remove</button>
            `;
            container.appendChild(div);
        }

        function removeLanguage(btn) {
            btn.parentElement.remove();
            updateResume();
        }

        function addReference() {
            const container = document.getElementById('referencesList');
            const div = document.createElement('div');
            div.className = 'dynamic-section';
            div.innerHTML = `
                <input type="text" placeholder="Reference Name" oninput="updateResume()">
                <input type="text" placeholder="Job Title" oninput="updateResume()">
                <input type="text" placeholder="Company" oninput="updateResume()">
                <input type="text" placeholder="Phone Number" oninput="updateResume()">
                <input type="email" placeholder="Email" oninput="updateResume()">
                <button class="btn btn-danger" onclick="removeReference(this)">Remove</button>
            `;
            container.appendChild(div);
        }

        function removeReference(btn) {
            btn.parentElement.remove();
            updateResume();
        }

        function updateResume() {
            const preview = document.getElementById('resumePreview');
            
            // Get personal info
            const name = document.getElementById('fullName').value || 'Your Name';
            const phone = document.getElementById('phone').value;
            const email = document.getElementById('email').value;
            const address = document.getElementById('address').value;
            const summary = document.getElementById('summary').value;

            // Get social links
            const socialLinks = Array.from(document.querySelectorAll('#socialLinks .social-links')).map(link => {
                const platform = link.querySelector('select').value;
                const url = link.querySelector('input[type="url"]').value;
                return { platform, url };
            }).filter(link => link.url);

            // Get skills
            const skills = Array.from(document.querySelectorAll('#skillsList input')).map(input => input.value).filter(skill => skill);

            // Get experience
            const experiences = Array.from(document.querySelectorAll('#experienceList .dynamic-section')).map(exp => {
                const inputs = exp.querySelectorAll('input, textarea');
                return {
                    title: inputs[0].value,
                    company: inputs[1].value,
                    startDate: inputs[2].value,
                    endDate: inputs[3].value,
                    description: inputs[4].value
                };
            }).filter(exp => exp.title || exp.company);

            // Get education
            const education = Array.from(document.querySelectorAll('#educationList .dynamic-section')).map(edu => {
                const inputs = edu.querySelectorAll('input');
                return {
                    degree: inputs[0].value,
                    institution: inputs[1].value,
                    year: inputs[2].value,
                    grade: inputs[3].value
                };
            }).filter(edu => edu.degree || edu.institution);

            // Get certifications
            const certifications = Array.from(document.querySelectorAll('#certificationsList .dynamic-section')).map(cert => {
                const inputs = cert.querySelectorAll('input');
                return {
                    name: inputs[0].value,
                    organization: inputs[1].value,
                    year: inputs[2].value
                };
            }).filter(cert => cert.name);

            // Get languages
            const languages = Array.from(document.querySelectorAll('#languagesList .dynamic-section')).map(lang => {
                const input = lang.querySelector('input');
                const select = lang.querySelector('select');
                return {
                    language: input.value,
                    proficiency: select.value
                };
            }).filter(lang => lang.language);

            // Get references
            const references = Array.from(document.querySelectorAll('#referencesList .dynamic-section')).map(ref => {
                const inputs = ref.querySelectorAll('input');
                return {
                    name: inputs[0].value,
                    title: inputs[1].value,
                    company: inputs[2].value,
                    phone: inputs[3].value,
                    email: inputs[4].value
                };
            }).filter(ref => ref.name);

            // Generate resume HTML
            let resumeHTML = `
                <div class="resume-header">
                    ${profilePicData ? `<img src="${profilePicData}" class="profile-picture" alt="Profile Picture">` : ''}
                    <h1>${name}</h1>
                    <div class="contact-info">
                        ${phone ? `<span>üìû ${phone}</span>` : ''}
                        ${email ? `<span>‚úâÔ∏è ${email}</span>` : ''}
                        ${address ? `<span>üìç ${address}</span>` : ''}
                    </div>
                    ${socialLinks.length ? `
                        <div class="contact-info">
                            ${socialLinks.map(link => `<span>üîó ${link.platform}: ${link.url}</span>`).join('')}
                        </div>
                    ` : ''}
                </div>

                ${summary ? `
                    <div class="resume-section">
                        <h2>Professional Summary</h2>
                        <p>${summary}</p>
                    </div>
                ` : ''}

                ${skills.length ? `
                    <div class="resume-section">
                        <h2>Skills</h2>
                        <div class="skills-grid">
                            ${skills.map(skill => `<div class="skill-item">${skill}</div>`).join('')}
                        </div>
                    </div>
                ` : ''}

                ${experiences.length ? `
                    <div class="resume-section">
                        <h2>Work Experience</h2>
                        ${experiences.map(exp => `
                            <div class="experience-item">
                                <div class="experience-header">
                                    <div>
                                        <div class="job-title">${exp.title}</div>
                                        <div class="company">${exp.company}</div>
                                    </div>
                                    <div class="date-range">
                                        ${exp.startDate} - ${exp.endDate || 'Present'}
                                    </div>
                                </div>
                                ${exp.description ? `<p>${exp.description}</p>` : ''}
                            </div>
                        `).join('')}
                    </div>
                ` : ''}

                ${education.length ? `
                    <div class="resume-section">
                        <h2>Education</h2>
                        ${education.map(edu => `
                            <div class="education-item">
                                <div class="experience-header">
                                    <div>
                                        <div class="job-title">${edu.degree}</div>
                                        <div class="company">${edu.institution}</div>
                                    </div>
                                    <div class="date-range">${edu.year}</div>
                                </div>
                                ${edu.grade ? `<p>Grade: ${edu.grade}</p>` : ''}
                            </div>
                        `).join('')}
                    </div>
                ` : ''}

                ${certifications.length ? `
                    <div class="resume-section">
                        <h2>Certifications</h2>
                        ${certifications.map(cert => `
                            <div class="certification-item">
                                <div class="experience-header">
                                    <div>
                                        <div class="job-title">${cert.name}</div>
                                        <div class="company">${cert.organization}</div>
                                    </div>
                                    <div class="date-range">${cert.year}</div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                ` : ''}

                ${languages.length ? `
                    <div class="resume-section">
                        <h2>Languages</h2>
                        <div class="languages-grid">
                            ${languages.map(lang => `
                                <div class="language-item">
                                    <span>${lang.language}</span>
                                    <span>${lang.proficiency}</span>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                ` : ''}

                ${references.length ? `
                    <div class="resume-section">
                        <h2>References</h2>
                        ${references.map(ref => `
                            <div class="reference-item">
                                <div class="job-title">${ref.name}</div>
                                <div class="company">${ref.title} - ${ref.company}</div>
                                <div>üìû ${ref.phone} | ‚úâÔ∏è ${ref.email}</div>
                            </div>
                        `).join('')}
                    </div>
                ` : ''}
            `;

            preview.innerHTML = resumeHTML;
        }

        function downloadPDF() {
            const element = document.getElementById('resumePreview');
            const name = document.getElementById('fullName').value || 'Resume';
            
            const opt = {
                margin: 0.5,
                filename: `${name}_Resume.pdf`,
                image: { type: 'jpeg', quality: 0.98 },
                html2canvas: { scale: 2 },
                jsPDF: { unit: 'in', format: 'letter', orientation: 'portrait' }
            };

            html2pdf().set(opt).from(element).save();
        }

        function printResume() {
            const printWindow = window.open('', '_blank');
            const resumeContent = document.getElementById('resumePreview').innerHTML;
            
            printWindow.document.write(`
                <!DOCTYPE html>
                <html>
                <head>
                    <title>Resume</title>
                    <style>
                        body {
                            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                            line-height: 1.6;
                            color: #333;
                            margin: 0;
                            padding: 20px;
                        }
                        .resume-header {
                            text-align: center;
                            margin-bottom: 30px;
                            border-bottom: 3px solid #667eea;
                            padding-bottom: 20px;
                        }
                        .resume-header h1 {
                            font-size: 2.5rem;
                            color: #2c3e50;
                            margin-bottom: 10px;
                        }
                        .contact-info {
                            display: flex;
                            justify-content: center;
                            flex-wrap: wrap;
                            gap: 20px;
                            margin-bottom: 15px;
                        }
                        .profile-picture {
                            width: 120px;
                            height: 120px;
                            border-radius: 50%;
                            object-fit: cover;
                            border: 4px solid #667eea;
                            margin: 0 auto 20px;
                        }
                        .resume-section {
                            margin-bottom: 25px;
                        }
                        .resume-section h2 {
                            color: #2c3e50;
                            font-size: 1.4rem;
                            margin-bottom: 15px;
                            border-bottom: 2px solid #667eea;
                            padding-bottom: 5px;
                        }
                        .experience-item, .education-item, .certification-item {
                            margin-bottom: 15px;
                            padding-left: 15px;
                            border-left: 3px solid #667eea;
                        }
                        .experience-header {
                            display: flex;
                            justify-content: space-between;
                            align-items: center;
                            margin-bottom: 5px;
                        }
                        .job-title {
                            font-weight: bold;
                            color: #2c3e50;
                        }
                        .company {
                            font-style: italic;
                            color: #555;
                        }
                        .date-range {
                            color: #667eea;
                            font-weight: 500;
                        }
                        .skills-grid {
                            display: grid;
                            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                            gap: 10px;
                        }
                        .skill-item {
                            background: #f8f9fa;
                            padding: 8px 12px;
                            border-radius: 20px;
                            text-align: center;
                            border: 1px solid #e1e8ed;
                        }
                        .languages-grid {
                            display: grid;
                            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
                            gap: 10px;
                        }
                        .language-item {
                            display: flex;
                            justify-content: space-between;
                            padding: 5px 0;
                            border-bottom: 1px solid #e1e8ed;
                        }
                        .reference-item {
                            margin-bottom: 15px;
                            padding: 10px;
                            background: #f8f9fa;
                            border-radius: 8px;
                        }
                        @media print {
                            body { margin: 0; }
                        }
                    </style>
                </head>
                <body>
                    ${resumeContent}
                </body>
                </html>
            `);
            
            printWindow.document.close();
            printWindow.focus();
            
            setTimeout(() => {
                printWindow.print();
                printWindow.close();
            }, 250);
        }

        // Initialize the resume on page load
        document.addEventListener('DOMContentLoaded', function() {
            updateResume();
            
            // Add smooth scrolling to sections
            const sections = document.querySelectorAll('.section');
            sections.forEach((section, index) => {
                setTimeout(() => {
                    section.classList.add('fade-in');
                }, index * 100);
            });
        });

        // Auto-save functionality (using memory storage)
        let autoSaveData = {};
        
        function autoSave() {
            // Collect all form data
            const formData = {
                fullName: document.getElementById('fullName').value,
                phone: document.getElementById('phone').value,
                email: document.getElementById('email').value,
                address: document.getElementById('address').value,
                summary: document.getElementById('summary').value,
                profilePic: profilePicData
            };
            
            // Store in memory for the session
            autoSaveData = formData;
            
            // Show a subtle save indicator
            showSaveIndicator();
        }
        
        function showSaveIndicator() {
            const indicator = document.createElement('div');
            indicator.textContent = '‚úì Saved';
            indicator.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: #28a745;
                color: white;
                padding: 8px 16px;
                border-radius: 20px;
                font-size: 12px;
                z-index: 1000;
                opacity: 0;
                transition: opacity 0.3s ease;
            `;
            
            document.body.appendChild(indicator);
            
            setTimeout(() => indicator.style.opacity = '1', 10);
            setTimeout(() => {
                indicator.style.opacity = '0';
                setTimeout(() => document.body.removeChild(indicator), 300);
            }, 2000);
        }
        
        // Auto-save every 5 seconds
        setInterval(autoSave, 5000);
        
        // Enhanced form validation
        function validateForm() {
            const requiredFields = ['fullName', 'email'];
            let isValid = true;
            
            requiredFields.forEach(fieldId => {
                const field = document.getElementById(fieldId);
                if (!field.value.trim()) {
                    field.style.borderColor = '#dc3545';
                    isValid = false;
                } else {
                    field.style.borderColor = '#28a745';
                }
            });
            
            return isValid;
        }
        
        // Add form validation on download
        function downloadPDF() {
            if (!validateForm()) {
                alert('Please fill in all required fields (Name and Email) before downloading.');
                return;
            }
            
            const element = document.getElementById('resumePreview');
            const name = document.getElementById('fullName').value || 'Resume';
            
            const opt = {
                margin: [0.5, 0.5, 0.5, 0.5],
                filename: `${name.replace(/\s+/g, '_')}_Resume.pdf`,
                image: { type: 'jpeg', quality: 0.98 },
                html2canvas: { 
                    scale: 2,
                    useCORS: true,
                    letterRendering: true
                },
                jsPDF: { 
                    unit: 'in', 
                    format: 'letter', 
                    orientation: 'portrait' 
                }
            };

            // Show loading indicator
            const loadingDiv = document.createElement('div');
            loadingDiv.innerHTML = `
                <div style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
                           background: rgba(0,0,0,0.8); display: flex; justify-content: center; 
                           align-items: center; z-index: 9999; color: white; font-size: 18px;">
                    <div style="text-align: center;">
                        <div style="border: 4px solid #f3f3f3; border-top: 4px solid #667eea; 
                                   border-radius: 50%; width: 40px; height: 40px; 
                                   animation: spin 2s linear infinite; margin: 0 auto 20px;"></div>
                        Generating PDF...
                    </div>
                </div>
                <style>
                    @keyframes spin {
                        0% { transform: rotate(0deg); }
                        100% { transform: rotate(360deg); }
                    }
                </style>
            `;
            document.body.appendChild(loadingDiv);

            html2pdf().set(opt).from(element).save().then(() => {
                document.body.removeChild(loadingDiv);
            });
        }
    </script>
</body>
</html>